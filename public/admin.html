<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin - Shop THB</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f5f7fa;
            color: #333;
        }

        /* Login Screen */
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .login-box {
            background: white;
            padding: 40px;
            border-radius: 10px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            width: 100%;
            max-width: 400px;
        }

        .login-box h1 {
            text-align: center;
            margin-bottom: 30px;
            color: #667eea;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .form-group input {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s;
            width: 100%;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn-primary:hover {
            background: #5568d3;
        }

        .btn-danger {
            background: #e74c3c;
            color: white;
        }

        .btn-danger:hover {
            background: #c0392b;
        }

        .error-message {
            color: #e74c3c;
            margin-top: 10px;
            font-size: 14px;
        }

        /* Admin Dashboard */
        .admin-container {
            display: none;
        }

        .admin-container.active {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar */
        .admin-sidebar {
            width: 260px;
            background: linear-gradient(180deg, #1e3a8a 0%, #1e40af 100%);
            color: white;
            padding: 0;
            box-shadow: 2px 0 10px rgba(0,0,0,0.1);
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            z-index: 100;
        }

        .logo-container {
            padding: 25px 20px;
            background: rgba(0,0,0,0.2);
            border-bottom: 1px solid rgba(255,255,255,0.1);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo-icon {
            width: 50px;
            height: 50px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .logo-icon svg {
            width: 100%;
            height: 100%;
        }

        .logo-text {
            font-size: 22px;
            font-weight: bold;
            letter-spacing: 1px;
        }

        .sidebar-menu {
            padding: 20px 0;
        }

        .menu-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 14px 20px;
            color: rgba(255,255,255,0.8);
            cursor: pointer;
            transition: all 0.3s;
            border-left: 3px solid transparent;
        }

        .menu-item:hover {
            background: rgba(255,255,255,0.1);
            color: white;
            border-left-color: #60a5fa;
        }

        .menu-item.active {
            background: rgba(255,255,255,0.15);
            color: white;
            border-left-color: #60a5fa;
            font-weight: 600;
        }

        .menu-item-icon {
            font-size: 20px;
            width: 24px;
            text-align: center;
        }

        .menu-item-text {
            flex: 1;
        }

        /* Main Content */
        .admin-main {
            flex: 1;
            margin-left: 260px;
            background: #f8fafc;
        }

        .admin-header {
            background: white;
            padding: 20px 30px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .admin-header h1 {
            font-size: 24px;
            color: #1e293b;
            margin: 0;
        }

        .admin-actions {
            display: flex;
            gap: 10px;
        }

        .admin-content {
            padding: 30px;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 24px;
            margin-bottom: 30px;
        }

        .dashboard-card {
            background: white;
            padding: 28px;
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: all 0.3s;
            border: 1px solid #e2e8f0;
        }

        .dashboard-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            border-color: #667eea;
        }

        .dashboard-card-icon {
            font-size: 42px;
            margin-bottom: 16px;
            display: inline-block;
        }

        .dashboard-card h3 {
            color: #1e293b;
            margin-bottom: 8px;
            font-size: 18px;
            font-weight: 600;
        }

        .dashboard-card p {
            color: #64748b;
            font-size: 14px;
            margin: 0;
        }

        /* Table Styles */
        .table-container {
            background: white;
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            overflow: hidden;
            border: 1px solid #e2e8f0;
        }

        .table-header {
            padding: 24px 28px;
            background: #f8fafc;
            border-bottom: 1px solid #e2e8f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 15px;
        }

        .table-header h2 {
            color: #1e293b;
            font-size: 20px;
            font-weight: 600;
            margin: 0;
        }

        .search-box {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .search-box input {
            padding: 10px 14px;
            border: 1px solid #cbd5e1;
            border-radius: 8px;
            font-size: 14px;
            transition: all 0.3s;
        }

        .search-box input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .search-box select {
            padding: 10px 14px;
            border: 1px solid #cbd5e1;
            border-radius: 8px;
            font-size: 14px;
            background: white;
            cursor: pointer;
            transition: all 0.3s;
        }

        .search-box select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #dee2e6;
        }

        th {
            background: #f8fafc;
            font-weight: 600;
            color: #475569;
            font-size: 13px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        tr:hover {
            background: #f8fafc;
        }

        td {
            color: #334155;
            font-size: 14px;
        }

        .status-badge {
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 500;
        }

        .status-new { background: #e3f2fd; color: #1976d2; }
        .status-processing { background: #fff3e0; color: #f57c00; }
        .status-shipping { background: #f3e5f5; color: #7b1fa2; }
        .status-completed { background: #e8f5e9; color: #388e3c; }
        .status-cancelled { background: #ffebee; color: #d32f2f; }

        .btn-sm {
            padding: 6px 12px;
            font-size: 14px;
            border-radius: 5px;
            border: none;
            cursor: pointer;
            margin: 0 3px;
        }

        .btn-edit {
            background: #667eea;
            color: white;
        }

        .btn-delete {
            background: #e74c3c;
            color: white;
        }

        .btn-view {
            background: #27ae60;
            color: white;
        }

        /* Form Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            overflow-y: auto;
        }

        .modal.active {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 10px;
            width: 100%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-header h2 {
            color: #667eea;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #999;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        .form-group-full {
            grid-column: 1 / -1;
        }

        /* Pagination */
        .pagination {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
            padding: 20px;
        }

        .pagination button {
            padding: 8px 15px;
            border: 1px solid #ddd;
            background: white;
            cursor: pointer;
            border-radius: 5px;
        }

        .pagination button.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .pagination button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Statistics */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: white;
            padding: 24px;
            border-radius: 12px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            border: 1px solid #e2e8f0;
            transition: all 0.3s;
        }

        .stat-card:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }

        .stat-card h4 {
            color: #64748b;
            font-size: 13px;
            margin-bottom: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 500;
        }

        .stat-card .value {
            font-size: 32px;
            font-weight: 700;
            color: #1e293b;
        }

        /* Hidden */
        .hidden {
            display: none !important;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #999;
        }
    </style>
</head>
<body>
    <!-- Login Screen -->
    <div id="loginScreen" class="login-container">
        <div class="login-box">
            <h1>ƒêƒÉng nh·∫≠p Admin</h1>
            <form id="loginForm">
                <div class="form-group">
                    <label>Username</label>
                    <input type="text" id="loginEmail" placeholder="Nh·∫≠p username" required>
                </div>
                <div class="form-group">
                    <label>M·∫≠t kh·∫©u</label>
                    <input type="password" id="loginPassword" placeholder="Nh·∫≠p m·∫≠t kh·∫©u" required>
                </div>
                <button type="submit" class="btn btn-primary">ƒêƒÉng nh·∫≠p</button>
                <div id="loginError" class="error-message"></div>
            </form>
        </div>
    </div>

    <!-- Admin Dashboard -->
    <div id="adminScreen" class="admin-container">
        <!-- Sidebar -->
        <div class="admin-sidebar">
            <div class="logo-container">
                <div class="logo-icon">
                    <svg viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                        <!-- Monitor outline -->
                        <rect x="15" y="20" width="70" height="50" fill="none" stroke="white" stroke-width="2.5" rx="3"/>
                        <!-- Monitor stand -->
                        <rect x="40" y="70" width="20" height="8" fill="white"/>
                        <rect x="35" y="78" width="30" height="3" fill="white" rx="1"/>
                        <!-- Circuit board lines inside monitor -->
                        <line x1="25" y1="35" x2="75" y2="35" stroke="white" stroke-width="1.5"/>
                        <line x1="25" y1="45" x2="75" y2="45" stroke="white" stroke-width="1.5"/>
                        <line x1="25" y1="55" x2="75" y2="55" stroke="white" stroke-width="1.5"/>
                        <!-- Circuit components (circles) -->
                        <circle cx="30" cy="35" r="2" fill="white"/>
                        <circle cx="50" cy="35" r="2" fill="white"/>
                        <circle cx="70" cy="35" r="2" fill="white"/>
                        <circle cx="35" cy="45" r="2" fill="white"/>
                        <circle cx="55" cy="45" r="2" fill="white"/>
                        <circle cx="40" cy="55" r="2" fill="white"/>
                        <circle cx="60" cy="55" r="2" fill="white"/>
                        <!-- Vertical connections -->
                        <line x1="30" y1="33" x2="30" y2="37" stroke="white" stroke-width="1"/>
                        <line x1="50" y1="33" x2="50" y2="37" stroke="white" stroke-width="1"/>
                        <line x1="35" y1="43" x2="35" y2="47" stroke="white" stroke-width="1"/>
                        <!-- Curved lines around monitor -->
                        <path d="M 10 25 Q 5 20, 10 15" stroke="white" stroke-width="2" fill="none" stroke-linecap="round"/>
                        <path d="M 90 25 Q 95 20, 90 15" stroke="white" stroke-width="2" fill="none" stroke-linecap="round"/>
                    </svg>
                </div>
                <div class="logo-text">THB</div>
            </div>
            <div class="sidebar-menu">
                <div class="menu-item active" onclick="showDashboard()">
                    <span class="menu-item-icon">üìä</span>
                    <span class="menu-item-text">T·ªïng quan</span>
                </div>
                <div class="menu-item" onclick="showOrders()">
                    <span class="menu-item-icon">üõí</span>
                    <span class="menu-item-text">ƒê∆°n h√†ng</span>
                </div>
                <div class="menu-item" onclick="showProducts()">
                    <span class="menu-item-icon">üì¶</span>
                    <span class="menu-item-text">S·∫£n ph·∫©m</span>
                </div>
                <div class="menu-item" onclick="showCategories()">
                    <span class="menu-item-icon">üìÅ</span>
                    <span class="menu-item-text">Danh m·ª•c</span>
                </div>
                <div class="menu-item" onclick="showCustomers()">
                    <span class="menu-item-icon">üë•</span>
                    <span class="menu-item-text">Kh√°ch h√†ng</span>
                </div>
                <div class="menu-item" onclick="showStatistics()">
                    <span class="menu-item-icon">üìà</span>
                    <span class="menu-item-text">Th·ªëng k√™</span>
                </div>
                <div class="menu-item" onclick="showVouchers()">
                    <span class="menu-item-icon">üé´</span>
                    <span class="menu-item-text">Qu·∫£n l√Ω Voucher</span>
                </div>
                <div class="menu-item" onclick="showAPIManagement()">
                    <span class="menu-item-icon">üîå</span>
                    <span class="menu-item-text">Qu·∫£n l√Ω API</span>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="admin-main">
            <div class="admin-header">
                <h1 id="pageTitle">T·ªïng quan</h1>
                <div class="admin-actions">
                    <button class="btn btn-primary" onclick="showChangePassword()" style="width: auto; padding: 10px 20px;">ƒê·ªïi m·∫≠t kh·∫©u</button>
                    <button class="btn btn-danger" onclick="logout()" style="width: auto; padding: 10px 20px;">ƒêƒÉng xu·∫•t</button>
                </div>
            </div>

            <div class="admin-content">
                <!-- Dashboard Menu -->
                <div id="dashboardMenu" class="dashboard-grid">
                <div class="dashboard-card" onclick="showOrders()">
                    <div class="dashboard-card-icon">üõí</div>
                    <h3>ƒê∆°n h√†ng</h3>
                    <p>Qu·∫£n l√Ω ƒë∆°n h√†ng</p>
                </div>
                <div class="dashboard-card" onclick="showCategories()">
                    <div class="dashboard-card-icon">üìÅ</div>
                    <h3>Danh m·ª•c</h3>
                    <p>Qu·∫£n l√Ω danh m·ª•c</p>
                </div>
                <div class="dashboard-card" onclick="showProducts()">
                    <div class="dashboard-card-icon">üì¶</div>
                    <h3>S·∫£n ph·∫©m</h3>
                    <p>Qu·∫£n l√Ω s·∫£n ph·∫©m</p>
                </div>
                <div class="dashboard-card" onclick="showCustomers()">
                    <div class="dashboard-card-icon">üë•</div>
                    <h3>Kh√°ch h√†ng</h3>
                    <p>Qu·∫£n l√Ω kh√°ch h√†ng</p>
                </div>
                <div class="dashboard-card" onclick="showStatistics()">
                    <div class="dashboard-card-icon">üìä</div>
                    <h3>Th·ªëng k√™</h3>
                    <p>Xem th·ªëng k√™</p>
                </div>
                <div class="dashboard-card" onclick="showVouchers()">
                    <div class="dashboard-card-icon">üé´</div>
                    <h3>Qu·∫£n l√Ω Voucher</h3>
                    <p>Qu·∫£n l√Ω voucher kh√°ch h√†ng</p>
                </div>
                <div class="dashboard-card" onclick="showAPIManagement()">
                    <div class="dashboard-card-icon">üîå</div>
                    <h3>Qu·∫£n l√Ω API</h3>
                    <p>Xem danh s√°ch API endpoints</p>
                </div>
            </div>

            <!-- Orders Management -->
            <div id="ordersSection" class="hidden">
                <div class="table-container">
                    <div class="table-header">
                        <h2>Qu·∫£n l√Ω ƒë∆°n h√†ng</h2>
                        <div class="search-box">
                            <input type="text" id="orderSearch" placeholder="T√¨m ki·∫øm..." onkeyup="loadOrders()">
                            <select id="orderStatusFilter" onchange="loadOrders()">
                                <option value="">T·∫•t c·∫£ tr·∫°ng th√°i</option>
                                <option value="new">M·ªõi</option>
                                <option value="processing">ƒêang x·ª≠ l√Ω</option>
                                <option value="shipping">ƒêang giao</option>
                                <option value="completed">Ho√†n th√†nh</option>
                                <option value="cancelled">ƒê√£ h·ªßy</option>
                            </select>
                        </div>
                    </div>
                    <div id="ordersTable"></div>
                    <div id="ordersPagination" class="pagination"></div>
                </div>
            </div>

            <!-- Products Management -->
            <div id="productsSection" class="hidden">
                <div class="table-container">
                    <div class="table-header">
                        <h2>Qu·∫£n l√Ω s·∫£n ph·∫©m</h2>
                        <div class="search-box">
                            <input type="text" id="productSearch" placeholder="T√¨m ki·∫øm..." onkeyup="loadProducts()">
                            <button class="btn btn-primary" onclick="showAddProduct()">Th√™m s·∫£n ph·∫©m</button>
                        </div>
                    </div>
                    <div id="productsTable"></div>
                    <div id="productsPagination" class="pagination"></div>
                </div>
            </div>

            <!-- Categories Management -->
            <div id="categoriesSection" class="hidden">
                <div class="table-container">
                    <div class="table-header">
                        <h2>Qu·∫£n l√Ω danh m·ª•c</h2>
                        <div class="search-box">
                            <input type="text" id="categorySearch" placeholder="T√¨m ki·∫øm..." onkeyup="loadCategories()">
                            <button class="btn btn-primary" onclick="showAddCategory()">Th√™m danh m·ª•c</button>
                        </div>
                    </div>
                    <div id="categoriesTable"></div>
                    <div id="categoriesPagination" class="pagination"></div>
                </div>
            </div>

            <!-- Customers Management -->
            <div id="customersSection" class="hidden">
                <div class="table-container">
                    <div class="table-header">
                        <h2>Qu·∫£n l√Ω kh√°ch h√†ng</h2>
                        <div class="search-box">
                            <input type="text" id="customerSearch" placeholder="T√¨m ki·∫øm..." onkeyup="loadCustomers()">
                        </div>
                    </div>
                    <div id="customersTable"></div>
                    <div id="customersPagination" class="pagination"></div>
                </div>
            </div>

            <!-- Statistics -->
            <div id="statisticsSection" class="hidden">
                <h2 style="margin-bottom: 20px;">Th·ªëng k√™</h2>
                <div id="statisticsContent"></div>
            </div>

            <!-- Vouchers Management -->
            <div id="vouchersSection" class="hidden">
                <div class="table-container">
                    <div class="table-header">
                        <h2>Qu·∫£n l√Ω Voucher</h2>
                        <div class="search-box">
                            <input type="text" id="voucherSearch" placeholder="T√¨m ki·∫øm..." onkeyup="loadVouchers()">
                            <select id="voucherStatusFilter" onchange="loadVouchers()">
                                <option value="">T·∫•t c·∫£ tr·∫°ng th√°i</option>
                                <option value="1">Ho·∫°t ƒë·ªông</option>
                                <option value="0">·∫®n</option>
                            </select>
                            <button class="btn btn-primary" onclick="showAddVoucher()">Th√™m voucher</button>
                        </div>
                    </div>
                    <div id="vouchersTable"></div>
                    <div id="vouchersPagination" class="pagination"></div>
                </div>
            </div>

            <!-- API Management -->
            <div id="apiManagementSection" class="hidden">
                <div class="table-container">
                    <div class="table-header">
                        <h2>Qu·∫£n l√Ω API Endpoints</h2>
                        <div class="search-box">
                            <input type="text" id="apiSearch" placeholder="T√¨m ki·∫øm endpoint..." onkeyup="filterAPIs()">
                        </div>
                    </div>
                    <div id="apiContent" style="padding: 24px;">
                        <div id="apiList"></div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <!-- Change Password Modal -->
    <div id="changePasswordModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ƒê·ªïi m·∫≠t kh·∫©u</h2>
                <button class="close-btn" onclick="closeModal('changePasswordModal')">&times;</button>
            </div>
            <form id="changePasswordForm">
                <div class="form-group">
                    <label>M·∫≠t kh·∫©u hi·ªán t·∫°i</label>
                    <input type="password" id="oldPassword" required>
                </div>
                <div class="form-group">
                    <label>M·∫≠t kh·∫©u m·ªõi</label>
                    <input type="password" id="newPassword" required>
                </div>
                <div class="form-group">
                    <label>X√°c nh·∫≠n m·∫≠t kh·∫©u m·ªõi</label>
                    <input type="password" id="confirmPassword" required>
                </div>
                <button type="submit" class="btn btn-primary">ƒê·ªïi m·∫≠t kh·∫©u</button>
                <div id="changePasswordError" class="error-message"></div>
            </form>
        </div>
    </div>

    <!-- Add/Edit Product Modal -->
    <div id="productModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="productModalTitle">Th√™m s·∫£n ph·∫©m</h2>
                <button class="close-btn" onclick="closeModal('productModal')">&times;</button>
            </div>
            <form id="productForm">
                <input type="hidden" id="productId">
                <div class="form-group">
                    <label>T√™n s·∫£n ph·∫©m</label>
                    <input type="text" id="productName" required>
                </div>
                <div class="form-group">
                    <label>Danh m·ª•c</label>
                    <select id="productCategory" required></select>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Gi√° nh·∫≠p</label>
                        <input type="number" id="productImportPrice" required>
                    </div>
                    <div class="form-group">
                        <label>Gi√° b√°n</label>
                        <input type="number" id="productPrice" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>S·ªë l∆∞·ª£ng</label>
                        <input type="number" id="productStock" required>
                    </div>
                    <div class="form-group">
                        <label>T·ªìn kho t·ªëi thi·ªÉu</label>
                        <input type="number" id="productMinStock" required>
                    </div>
                </div>
                <div class="form-group">
                    <label>Link ·∫£nh</label>
                    <input type="text" id="productImage">
                </div>
                <div class="form-group">
                    <label>M√¥ t·∫£</label>
                    <textarea id="productDescription" rows="4" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;"></textarea>
                </div>
                <button type="submit" class="btn btn-primary">L∆∞u</button>
                <div id="productError" class="error-message"></div>
            </form>
        </div>
    </div>

    <!-- Add/Edit Category Modal -->
    <div id="categoryModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="categoryModalTitle">Th√™m danh m·ª•c</h2>
                <button class="close-btn" onclick="closeModal('categoryModal')">&times;</button>
            </div>
            <form id="categoryForm">
                <input type="hidden" id="categoryId">
                <div class="form-group">
                    <label>T√™n danh m·ª•c</label>
                    <input type="text" id="categoryName" required>
                </div>
                <div class="form-group">
                    <label>M√¥ t·∫£</label>
                    <textarea id="categoryDescription" rows="4" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;"></textarea>
                </div>
                <button type="submit" class="btn btn-primary">L∆∞u</button>
                <div id="categoryError" class="error-message"></div>
            </form>
        </div>
    </div>

    <!-- Add/Edit Voucher Modal -->
    <div id="voucherModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <div class="modal-header">
                <h2 id="voucherModalTitle">Th√™m voucher</h2>
                <button class="close-btn" onclick="closeModal('voucherModal')">&times;</button>
            </div>
            <form id="voucherForm">
                <input type="hidden" id="voucherId">
                <div class="form-row">
                    <div class="form-group">
                        <label>M√£ voucher *</label>
                        <input type="text" id="voucherCode" required style="text-transform: uppercase;">
                    </div>
                    <div class="form-group">
                        <label>T√™n voucher *</label>
                        <input type="text" id="voucherName" required>
                    </div>
                </div>
                <div class="form-group">
                    <label>M√¥ t·∫£</label>
                    <textarea id="voucherDescription" rows="3" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 5px;"></textarea>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Lo·∫°i *</label>
                        <select id="voucherType" required onchange="toggleVoucherFields()">
                            <option value="percentage">Ph·∫ßn trƒÉm (%)</option>
                            <option value="fixed">S·ªë ti·ªÅn c·ªë ƒë·ªãnh (VNƒê)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Gi√° tr·ªã *</label>
                        <input type="number" id="voucherValue" required min="0" step="0.01">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group" id="maxDiscountGroup" style="display: none;">
                        <label>Gi·∫£m gi√° t·ªëi ƒëa (VNƒê)</label>
                        <input type="number" id="voucherMaxDiscount" min="0">
                    </div>
                    <div class="form-group">
                        <label>ƒê∆°n h√†ng t·ªëi thi·ªÉu (VNƒê)</label>
                        <input type="number" id="voucherMinOrderValue" min="0" value="0">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>S·ªë l∆∞·ª£ng *</label>
                        <input type="number" id="voucherQuantity" required min="1">
                    </div>
                    <div class="form-group">
                        <label>Tr·∫°ng th√°i</label>
                        <select id="voucherStatus">
                            <option value="1">Ho·∫°t ƒë·ªông</option>
                            <option value="0">·∫®n</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Ng√†y b·∫Øt ƒë·∫ßu *</label>
                        <input type="datetime-local" id="voucherStartDate" required>
                    </div>
                    <div class="form-group">
                        <label>Ng√†y k·∫øt th√∫c *</label>
                        <input type="datetime-local" id="voucherEndDate" required>
                    </div>
                </div>
                <div class="form-group">
                    <label>S·∫£n ph·∫©m √°p d·ª•ng (ƒë·ªÉ tr·ªëng = t·∫•t c·∫£)</label>
                    <input type="text" id="voucherProducts" placeholder="Nh·∫≠p ID s·∫£n ph·∫©m, c√°ch nhau b·ªüi d·∫•u ph·∫©y">
                </div>
                <div class="form-group">
                    <label>Danh m·ª•c √°p d·ª•ng (ƒë·ªÉ tr·ªëng = t·∫•t c·∫£)</label>
                    <input type="text" id="voucherCategories" placeholder="Nh·∫≠p ID danh m·ª•c, c√°ch nhau b·ªüi d·∫•u ph·∫©y">
                </div>
                <div class="form-group">
                    <label>Ng∆∞·ªùi d√πng √°p d·ª•ng (ƒë·ªÉ tr·ªëng = t·∫•t c·∫£)</label>
                    <input type="text" id="voucherUsers" placeholder="Nh·∫≠p ID ng∆∞·ªùi d√πng, c√°ch nhau b·ªüi d·∫•u ph·∫©y">
                </div>
                <button type="submit" class="btn btn-primary">L∆∞u</button>
                <div id="voucherError" class="error-message"></div>
            </form>
        </div>
    </div>

    <script>
        const API_BASE = '/api';
        let currentToken = localStorage.getItem('adminToken');
        let currentPage = {
            orders: 1,
            products: 1,
            categories: 1,
            customers: 1,
            vouchers: 1
        };

        // Check if already logged in
        if (currentToken) {
            showAdminScreen();
        }

        // Login
        document.getElementById('loginForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            const errorDiv = document.getElementById('loginError');

            try {
                const response = await fetch(`${API_BASE}/auth/login`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ username: email, password })
                });

                const data = await response.json();

                if (response.ok && data.user.role === 'admin') {
                    localStorage.setItem('adminToken', data.token);
                    currentToken = data.token;
                    showAdminScreen();
                } else {
                    errorDiv.textContent = data.message || 'Email ho·∫∑c m·∫≠t kh·∫©u kh√¥ng ƒë√∫ng!';
                }
            } catch (error) {
                errorDiv.textContent = 'L·ªói k·∫øt n·ªëi server!';
            }
        });

        function showAdminScreen() {
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('adminScreen').classList.add('active');
            loadDashboard();
        }

        function logout() {
            localStorage.removeItem('adminToken');
            currentToken = null;
            document.getElementById('loginScreen').style.display = 'flex';
            document.getElementById('adminScreen').classList.remove('active');
        }

        function getAuthHeaders() {
            return {
                'Content-Type': 'application/json',
                'Authorization': `Bearer ${currentToken}`
            };
        }

        // Navigation
        function updateActiveMenu(activeItem) {
            document.querySelectorAll('.menu-item').forEach(item => item.classList.remove('active'));
            if (activeItem) {
                activeItem.classList.add('active');
            }
        }

        function updatePageTitle(title) {
            document.getElementById('pageTitle').textContent = title;
        }

        function showSection(sectionId) {
            document.querySelectorAll('[id$="Section"]').forEach(el => el.classList.add('hidden'));
            document.getElementById(sectionId).classList.remove('hidden');
            document.getElementById('dashboardMenu').classList.add('hidden');
        }

        function showDashboard() {
            document.querySelectorAll('[id$="Section"]').forEach(el => el.classList.add('hidden'));
            document.getElementById('dashboardMenu').classList.remove('hidden');
            updatePageTitle('T·ªïng quan');
            updateActiveMenu(event?.target?.closest('.menu-item') || document.querySelector('.menu-item'));
        }

        function showOrders() {
            showSection('ordersSection');
            updatePageTitle('Qu·∫£n l√Ω ƒë∆°n h√†ng');
            updateActiveMenu(event?.target?.closest('.menu-item') || document.querySelectorAll('.menu-item')[1]);
            loadOrders();
        }

        function showProducts() {
            showSection('productsSection');
            updatePageTitle('Qu·∫£n l√Ω s·∫£n ph·∫©m');
            updateActiveMenu(event?.target?.closest('.menu-item') || document.querySelectorAll('.menu-item')[2]);
            loadProducts();
            loadCategoriesForSelect();
        }

        function showCategories() {
            showSection('categoriesSection');
            updatePageTitle('Qu·∫£n l√Ω danh m·ª•c');
            updateActiveMenu(event?.target?.closest('.menu-item') || document.querySelectorAll('.menu-item')[3]);
            loadCategories();
        }

        function showCustomers() {
            showSection('customersSection');
            updatePageTitle('Qu·∫£n l√Ω kh√°ch h√†ng');
            updateActiveMenu(event?.target?.closest('.menu-item') || document.querySelectorAll('.menu-item')[4]);
            loadCustomers();
        }

        function showStatistics() {
            showSection('statisticsSection');
            updatePageTitle('Th·ªëng k√™');
            updateActiveMenu(event?.target?.closest('.menu-item') || document.querySelectorAll('.menu-item')[5]);
            loadStatistics();
        }

        function showVouchers() {
            showSection('vouchersSection');
            updatePageTitle('Qu·∫£n l√Ω Voucher');
            updateActiveMenu(event?.target?.closest('.menu-item') || document.querySelectorAll('.menu-item')[6]);
            loadVouchers();
        }

        function showAPIManagement() {
            showSection('apiManagementSection');
            updatePageTitle('Qu·∫£n l√Ω API');
            updateActiveMenu(event?.target?.closest('.menu-item') || document.querySelectorAll('.menu-item')[7]);
            loadAPIs();
        }

        // Load Orders
        async function loadOrders(page = 1) {
            const search = document.getElementById('orderSearch')?.value || '';
            const status = document.getElementById('orderStatusFilter')?.value || '';
            const params = new URLSearchParams({ page, limit: 10 });
            if (status) params.append('status', status);

            try {
                const response = await fetch(`${API_BASE}/orders?${params}`, {
                    headers: getAuthHeaders()
                });
                const data = await response.json();

                if (response.ok) {
                    renderOrdersTable(data.orders);
                    renderPagination('ordersPagination', data.page, data.totalPages, (p) => {
                        currentPage.orders = p;
                        loadOrders(p);
                    });
                }
            } catch (error) {
                console.error('Error loading orders:', error);
            }
        }

        function renderOrdersTable(orders) {
            const table = `
                <table>
                    <thead>
                        <tr>
                            <th>M√£ ƒë∆°n</th>
                            <th>Kh√°ch h√†ng</th>
                            <th>T·ªïng ti·ªÅn</th>
                            <th>Tr·∫°ng th√°i</th>
                            <th>Ng√†y t·∫°o</th>
                            <th>Thao t√°c</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${orders.map(order => `
                            <tr>
                                <td>${order.orderNumber || order._id.slice(-8)}</td>
                                <td>${order.customer?.fullName || 'N/A'}</td>
                                <td>${order.total?.toLocaleString('vi-VN')} VNƒê</td>
                                <td><span class="status-badge status-${order.status}">${getStatusText(order.status)}</span></td>
                                <td>${new Date(order.createdAt).toLocaleDateString('vi-VN')}</td>
                                <td>
                                    <button class="btn-sm btn-view" onclick="viewOrder('${order._id}')">Xem</button>
                                    ${order.status !== 'completed' && order.status !== 'cancelled' ? 
                                        `<button class="btn-sm btn-edit" onclick="updateOrderStatus('${order._id}')">C·∫≠p nh·∫≠t</button>` : ''}
                                </td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
            document.getElementById('ordersTable').innerHTML = table;
        }

        function getStatusText(status) {
            const statusMap = {
                'new': 'M·ªõi',
                'processing': 'ƒêang x·ª≠ l√Ω',
                'shipping': 'ƒêang giao',
                'completed': 'Ho√†n th√†nh',
                'cancelled': 'ƒê√£ h·ªßy'
            };
            return statusMap[status] || status;
        }

        async function updateOrderStatus(orderId) {
            const status = prompt('Nh·∫≠p tr·∫°ng th√°i m·ªõi (new/processing/shipping/completed/cancelled):');
            if (!status) return;

            try {
                const response = await fetch(`${API_BASE}/orders/${orderId}/status`, {
                    method: 'PUT',
                    headers: getAuthHeaders(),
                    body: JSON.stringify({ status })
                });

                if (response.ok) {
                    alert('C·∫≠p nh·∫≠t th√†nh c√¥ng!');
                    loadOrders(currentPage.orders);
                } else {
                    const data = await response.json();
                    alert(data.message || 'C√≥ l·ªói x·∫£y ra!');
                }
            } catch (error) {
                alert('L·ªói k·∫øt n·ªëi server!');
            }
        }

        // Load Products
        async function loadProducts(page = 1) {
            const search = document.getElementById('productSearch')?.value || '';
            const params = new URLSearchParams({ page, limit: 10 });
            if (search) params.append('search', search);

            try {
                const response = await fetch(`${API_BASE}/products?${params}`, {
                    headers: getAuthHeaders()
                });
                const data = await response.json();

                if (response.ok) {
                    renderProductsTable(data.products);
                    renderPagination('productsPagination', data.page, data.totalPages, (p) => {
                        currentPage.products = p;
                        loadProducts(p);
                    });
                }
            } catch (error) {
                console.error('Error loading products:', error);
            }
        }

        function renderProductsTable(products) {
            const table = `
                <table>
                    <thead>
                        <tr>
                            <th>·∫¢nh</th>
                            <th>T√™n s·∫£n ph·∫©m</th>
                            <th>Danh m·ª•c</th>
                            <th>Gi√° b√°n</th>
                            <th>T·ªìn kho</th>
                            <th>Thao t√°c</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${products.map(product => `
                            <tr>
                                <td><img src="${product.image || product.images?.[0] || 'https://via.placeholder.com/50'}" style="width: 50px; height: 50px; object-fit: cover; border-radius: 5px;"></td>
                                <td>${product.name}</td>
                                <td>${product.category?.name || 'N/A'}</td>
                                <td>${product.price?.toLocaleString('vi-VN')} VNƒê</td>
                                <td>${product.stock || 0}</td>
                                <td>
                                    <button class="btn-sm btn-view" onclick="viewProduct('${product._id}')">Xem</button>
                                    <button class="btn-sm btn-edit" onclick="editProduct('${product._id}')">S·ª≠a</button>
                                    <button class="btn-sm btn-delete" onclick="deleteProduct('${product._id}')">X√≥a</button>
                                </td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
            document.getElementById('productsTable').innerHTML = table;
        }

        async function loadCategoriesForSelect() {
            try {
                const response = await fetch(`${API_BASE}/categories/all`);
                const data = await response.json();
                const select = document.getElementById('productCategory');
                select.innerHTML = '<option value="">Ch·ªçn danh m·ª•c</option>' + 
                    data.map(cat => `<option value="${cat._id}">${cat.name}</option>`).join('');
            } catch (error) {
                console.error('Error loading categories:', error);
            }
        }

        function showAddProduct() {
            document.getElementById('productId').value = '';
            document.getElementById('productForm').reset();
            document.getElementById('productModalTitle').textContent = 'Th√™m s·∫£n ph·∫©m';
            document.getElementById('productModal').classList.add('active');
        }

        async function editProduct(id) {
            try {
                const response = await fetch(`${API_BASE}/products/${id}`, {
                    headers: getAuthHeaders()
                });
                const product = await response.json();

                document.getElementById('productId').value = product._id;
                document.getElementById('productName').value = product.name || '';
                document.getElementById('productCategory').value = product.category?._id || product.category || '';
                document.getElementById('productImportPrice').value = product.importPrice || '';
                document.getElementById('productPrice').value = product.price || '';
                document.getElementById('productStock').value = product.stock || '';
                document.getElementById('productMinStock').value = product.minStock || '';
                document.getElementById('productImage').value = product.image || product.images?.[0] || '';
                document.getElementById('productDescription').value = product.description || '';

                document.getElementById('productModalTitle').textContent = 'S·ª≠a s·∫£n ph·∫©m';
                document.getElementById('productModal').classList.add('active');
            } catch (error) {
                alert('L·ªói t·∫£i d·ªØ li·ªáu s·∫£n ph·∫©m!');
            }
        }

        document.getElementById('productForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const id = document.getElementById('productId').value;
            const data = {
                name: document.getElementById('productName').value,
                category: document.getElementById('productCategory').value,
                importPrice: parseFloat(document.getElementById('productImportPrice').value),
                price: parseFloat(document.getElementById('productPrice').value),
                stock: parseInt(document.getElementById('productStock').value),
                minStock: parseInt(document.getElementById('productMinStock').value),
                image: document.getElementById('productImage').value,
                description: document.getElementById('productDescription').value
            };

            try {
                const url = id ? `${API_BASE}/products/${id}` : `${API_BASE}/products`;
                const method = id ? 'PUT' : 'POST';
                const response = await fetch(url, {
                    method,
                    headers: getAuthHeaders(),
                    body: JSON.stringify(data)
                });

                const result = await response.json();
                if (response.ok) {
                    alert('L∆∞u th√†nh c√¥ng!');
                    closeModal('productModal');
                    loadProducts(currentPage.products);
                } else {
                    document.getElementById('productError').textContent = result.message || 'C√≥ l·ªói x·∫£y ra!';
                }
            } catch (error) {
                document.getElementById('productError').textContent = 'L·ªói k·∫øt n·ªëi server!';
            }
        });

        async function deleteProduct(id) {
            if (!confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a s·∫£n ph·∫©m n√†y?')) return;

            try {
                const response = await fetch(`${API_BASE}/products/${id}`, {
                    method: 'DELETE',
                    headers: getAuthHeaders()
                });

                if (response.ok) {
                    alert('X√≥a th√†nh c√¥ng!');
                    loadProducts(currentPage.products);
                } else {
                    const data = await response.json();
                    alert(data.message || 'C√≥ l·ªói x·∫£y ra!');
                }
            } catch (error) {
                alert('L·ªói k·∫øt n·ªëi server!');
            }
        }

        // Load Categories
        async function loadCategories(page = 1) {
            const search = document.getElementById('categorySearch')?.value || '';
            const params = new URLSearchParams({ page, limit: 10 });
            if (search) params.append('search', search);

            try {
                const response = await fetch(`${API_BASE}/categories?${params}`, {
                    headers: getAuthHeaders()
                });
                const data = await response.json();

                if (response.ok) {
                    renderCategoriesTable(data.categories);
                    renderPagination('categoriesPagination', data.page, data.totalPages, (p) => {
                        currentPage.categories = p;
                        loadCategories(p);
                    });
                }
            } catch (error) {
                console.error('Error loading categories:', error);
            }
        }

        function renderCategoriesTable(categories) {
            const table = `
                <table>
                    <thead>
                        <tr>
                            <th>T√™n danh m·ª•c</th>
                            <th>M√¥ t·∫£</th>
                            <th>Tr·∫°ng th√°i</th>
                            <th>Thao t√°c</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${categories.map(cat => `
                            <tr>
                                <td>${cat.name}</td>
                                <td>${cat.description || 'N/A'}</td>
                                <td><span class="status-badge ${cat.status === 1 ? 'status-completed' : 'status-cancelled'}">${cat.status === 1 ? 'Ho·∫°t ƒë·ªông' : '·∫®n'}</span></td>
                                <td>
                                    <button class="btn-sm btn-edit" onclick="editCategory('${cat._id}')">S·ª≠a</button>
                                    <button class="btn-sm btn-delete" onclick="deleteCategory('${cat._id}')">X√≥a</button>
                                </td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
            document.getElementById('categoriesTable').innerHTML = table;
        }

        function showAddCategory() {
            document.getElementById('categoryId').value = '';
            document.getElementById('categoryForm').reset();
            document.getElementById('categoryModalTitle').textContent = 'Th√™m danh m·ª•c';
            document.getElementById('categoryModal').classList.add('active');
        }

        async function editCategory(id) {
            try {
                const response = await fetch(`${API_BASE}/categories/${id}`, {
                    headers: getAuthHeaders()
                });
                const category = await response.json();

                document.getElementById('categoryId').value = category._id;
                document.getElementById('categoryName').value = category.name || '';
                document.getElementById('categoryDescription').value = category.description || '';

                document.getElementById('categoryModalTitle').textContent = 'S·ª≠a danh m·ª•c';
                document.getElementById('categoryModal').classList.add('active');
            } catch (error) {
                alert('L·ªói t·∫£i d·ªØ li·ªáu danh m·ª•c!');
            }
        }

        document.getElementById('categoryForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const id = document.getElementById('categoryId').value;
            const data = {
                name: document.getElementById('categoryName').value,
                description: document.getElementById('categoryDescription').value
            };

            try {
                const url = id ? `${API_BASE}/categories/${id}` : `${API_BASE}/categories`;
                const method = id ? 'PUT' : 'POST';
                const response = await fetch(url, {
                    method,
                    headers: getAuthHeaders(),
                    body: JSON.stringify(data)
                });

                const result = await response.json();
                if (response.ok) {
                    alert('L∆∞u th√†nh c√¥ng!');
                    closeModal('categoryModal');
                    loadCategories(currentPage.categories);
                } else {
                    document.getElementById('categoryError').textContent = result.message || 'C√≥ l·ªói x·∫£y ra!';
                }
            } catch (error) {
                document.getElementById('categoryError').textContent = 'L·ªói k·∫øt n·ªëi server!';
            }
        });

        async function deleteCategory(id) {
            if (!confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a danh m·ª•c n√†y?')) return;

            try {
                const response = await fetch(`${API_BASE}/categories/${id}`, {
                    method: 'DELETE',
                    headers: getAuthHeaders()
                });

                if (response.ok) {
                    alert('X√≥a th√†nh c√¥ng!');
                    loadCategories(currentPage.categories);
                } else {
                    const data = await response.json();
                    alert(data.message || 'C√≥ l·ªói x·∫£y ra!');
                }
            } catch (error) {
                alert('L·ªói k·∫øt n·ªëi server!');
            }
        }

        // Load Customers
        async function loadCustomers(page = 1) {
            const search = document.getElementById('customerSearch')?.value || '';
            const params = new URLSearchParams({ page, limit: 10, role: 'customer' });
            if (search) params.append('search', search);

            try {
                const response = await fetch(`${API_BASE}/users?${params}`, {
                    headers: getAuthHeaders()
                });
                const data = await response.json();

                if (response.ok) {
                    renderCustomersTable(data.users);
                    renderPagination('customersPagination', data.page, data.totalPages, (p) => {
                        currentPage.customers = p;
                        loadCustomers(p);
                    });
                }
            } catch (error) {
                console.error('Error loading customers:', error);
            }
        }

        function renderCustomersTable(customers) {
            const table = `
                <table>
                    <thead>
                        <tr>
                            <th>T√™n</th>
                            <th>Email</th>
                            <th>S·ªë ƒëi·ªán tho·∫°i</th>
                            <th>Ng√†y t·∫°o</th>
                            <th>Thao t√°c</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${customers.map(customer => `
                            <tr>
                                <td>${customer.fullName || 'N/A'}</td>
                                <td>${customer.email || 'N/A'}</td>
                                <td>${customer.phone || 'N/A'}</td>
                                <td>${new Date(customer.createdAt).toLocaleDateString('vi-VN')}</td>
                                <td>
                                    <button class="btn-sm btn-view" onclick="viewCustomer('${customer._id}')">Xem</button>
                                </td>
                            </tr>
                        `).join('')}
                    </tbody>
                </table>
            `;
            document.getElementById('customersTable').innerHTML = table;
        }

        // Load Statistics
        async function loadStatistics() {
            try {
                const response = await fetch(`${API_BASE}/statistics/overview`, {
                    headers: getAuthHeaders()
                });
                const data = await response.json();

                if (response.ok) {
                    document.getElementById('statisticsContent').innerHTML = `
                        <div class="stats-grid">
                            <div class="stat-card">
                                <h4>T·ªïng ƒë∆°n h√†ng</h4>
                                <div class="value">${data.totalOrders || 0}</div>
                            </div>
                            <div class="stat-card">
                                <h4>T·ªïng doanh thu</h4>
                                <div class="value">${(data.totalRevenue || 0).toLocaleString('vi-VN')} VNƒê</div>
                            </div>
                            <div class="stat-card">
                                <h4>L·ª£i nhu·∫≠n</h4>
                                <div class="value">${(data.totalProfit || 0).toLocaleString('vi-VN')} VNƒê</div>
                            </div>
                            <div class="stat-card">
                                <h4>T·ªïng s·∫£n ph·∫©m</h4>
                                <div class="value">${data.totalProducts || 0}</div>
                            </div>
                            <div class="stat-card">
                                <h4>T·ªïng kh√°ch h√†ng</h4>
                                <div class="value">${data.totalCustomers || 0}</div>
                            </div>
                            <div class="stat-card">
                                <h4>S·∫£n ph·∫©m t·ªìn kho th·∫•p</h4>
                                <div class="value">${data.lowStockProducts || 0}</div>
                            </div>
                        </div>
                    `;
                }
            } catch (error) {
                document.getElementById('statisticsContent').innerHTML = '<div class="loading">L·ªói t·∫£i th·ªëng k√™!</div>';
            }
        }

        // Change Password
        function showChangePassword() {
            document.getElementById('changePasswordForm').reset();
            document.getElementById('changePasswordModal').classList.add('active');
        }

        document.getElementById('changePasswordForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const oldPassword = document.getElementById('oldPassword').value;
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;

            if (newPassword !== confirmPassword) {
                document.getElementById('changePasswordError').textContent = 'M·∫≠t kh·∫©u m·ªõi kh√¥ng kh·ªõp!';
                return;
            }

            try {
                const response = await fetch(`${API_BASE}/auth/change-password`, {
                    method: 'PUT',
                    headers: getAuthHeaders(),
                    body: JSON.stringify({ oldPassword, newPassword, confirmPassword })
                });

                const data = await response.json();
                if (response.ok) {
                    alert('ƒê·ªïi m·∫≠t kh·∫©u th√†nh c√¥ng!');
                    closeModal('changePasswordModal');
                } else {
                    document.getElementById('changePasswordError').textContent = data.message || 'C√≥ l·ªói x·∫£y ra!';
                }
            } catch (error) {
                document.getElementById('changePasswordError').textContent = 'L·ªói k·∫øt n·ªëi server!';
            }
        });

        // Utility functions
        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        function renderPagination(containerId, currentPage, totalPages, onPageChange) {
            const container = document.getElementById(containerId);
            if (totalPages <= 1) {
                container.innerHTML = '';
                return;
            }

            // Store callback in data attribute
            container.setAttribute('data-callback', onPageChange.toString());

            let html = '';
            if (currentPage > 1) {
                html += `<button onclick="handlePagination('${containerId}', ${currentPage - 1})">Tr∆∞·ªõc</button>`;
            }

            for (let i = 1; i <= totalPages; i++) {
                if (i === 1 || i === totalPages || (i >= currentPage - 2 && i <= currentPage + 2)) {
                    html += `<button class="${i === currentPage ? 'active' : ''}" onclick="handlePagination('${containerId}', ${i})">${i}</button>`;
                } else if (i === currentPage - 3 || i === currentPage + 3) {
                    html += `<span>...</span>`;
                }
            }

            if (currentPage < totalPages) {
                html += `<button onclick="handlePagination('${containerId}', ${currentPage + 1})">Sau</button>`;
            }

            container.innerHTML = html;
            // Store callback function reference
            container._callback = onPageChange;
        }

        function handlePagination(containerId, page) {
            const container = document.getElementById(containerId);
            if (container._callback) {
                container._callback(page);
            }
        }

        function loadDashboard() {
            // Load initial data if needed
        }

        // View functions
        async function viewOrder(id) {
            try {
                const response = await fetch(`${API_BASE}/orders/${id}`, {
                    headers: getAuthHeaders()
                });
                const order = await response.json();

                if (response.ok) {
                    const items = order.items?.map(item => 
                        `- ${item.product?.name || 'N/A'} x${item.quantity} = ${item.subtotal?.toLocaleString('vi-VN')} VNƒê`
                    ).join('\n') || 'Kh√¥ng c√≥ s·∫£n ph·∫©m';

                    alert(`Chi ti·∫øt ƒë∆°n h√†ng:\n\n` +
                        `M√£ ƒë∆°n: ${order.orderNumber || id}\n` +
                        `Kh√°ch h√†ng: ${order.customer?.fullName || 'N/A'}\n` +
                        `Email: ${order.customer?.email || 'N/A'}\n` +
                        `SƒêT: ${order.customer?.phone || 'N/A'}\n` +
                        `Tr·∫°ng th√°i: ${getStatusText(order.status)}\n` +
                        `T·ªïng ti·ªÅn: ${order.total?.toLocaleString('vi-VN')} VNƒê\n` +
                        `Ph∆∞∆°ng th·ª©c thanh to√°n: ${order.paymentMethod || 'N/A'}\n` +
                        `Ng√†y t·∫°o: ${new Date(order.createdAt).toLocaleString('vi-VN')}\n\n` +
                        `S·∫£n ph·∫©m:\n${items}`);
                } else {
                    alert('Kh√¥ng t√¨m th·∫•y ƒë∆°n h√†ng!');
                }
            } catch (error) {
                alert('L·ªói t·∫£i d·ªØ li·ªáu ƒë∆°n h√†ng!');
            }
        }

        async function viewProduct(id) {
            try {
                const response = await fetch(`${API_BASE}/products/${id}`, {
                    headers: getAuthHeaders()
                });
                const product = await response.json();

                if (response.ok) {
                    alert(`Chi ti·∫øt s·∫£n ph·∫©m:\n\n` +
                        `T√™n: ${product.name}\n` +
                        `Danh m·ª•c: ${product.category?.name || 'N/A'}\n` +
                        `Gi√° nh·∫≠p: ${product.importPrice?.toLocaleString('vi-VN')} VNƒê\n` +
                        `Gi√° b√°n: ${product.price?.toLocaleString('vi-VN')} VNƒê\n` +
                        `T·ªìn kho: ${product.stock || 0}\n` +
                        `T·ªìn kho t·ªëi thi·ªÉu: ${product.minStock || 0}\n` +
                        `ƒê√°nh gi√°: ${product.rating || 0}/5 (${product.totalReviews || 0} ƒë√°nh gi√°)\n` +
                        `Tr·∫°ng th√°i: ${product.status === 1 ? 'Ho·∫°t ƒë·ªông' : '·∫®n'}\n` +
                        `M√¥ t·∫£: ${product.description || 'N/A'}`);
                } else {
                    alert('Kh√¥ng t√¨m th·∫•y s·∫£n ph·∫©m!');
                }
            } catch (error) {
                alert('L·ªói t·∫£i d·ªØ li·ªáu s·∫£n ph·∫©m!');
            }
        }

        async function viewCustomer(id) {
            try {
                const response = await fetch(`${API_BASE}/users/${id}`, {
                    headers: getAuthHeaders()
                });
                const customer = await response.json();

                if (response.ok) {
                    // Get customer orders
                    const ordersResponse = await fetch(`${API_BASE}/users/${id}/orders`, {
                        headers: getAuthHeaders()
                    });
                    const orders = await ordersResponse.ok ? await ordersResponse.json() : [];

                    const totalSpent = orders.reduce((sum, order) => sum + (order.total || 0), 0);

                    alert(`Chi ti·∫øt kh√°ch h√†ng:\n\n` +
                        `T√™n: ${customer.fullName || 'N/A'}\n` +
                        `Email: ${customer.email || 'N/A'}\n` +
                        `SƒêT: ${customer.phone || 'N/A'}\n` +
                        `Ng√†y t·∫°o: ${new Date(customer.createdAt).toLocaleDateString('vi-VN')}\n` +
                        `T·ªïng ƒë∆°n h√†ng: ${orders.length}\n` +
                        `T·ªïng ti·ªÅn ƒë√£ mua: ${totalSpent.toLocaleString('vi-VN')} VNƒê`);
                } else {
                    alert('Kh√¥ng t√¨m th·∫•y kh√°ch h√†ng!');
                }
            } catch (error) {
                alert('L·ªói t·∫£i d·ªØ li·ªáu kh√°ch h√†ng!');
            }
        }

        // Voucher Management
        async function loadVouchers(page = 1) {
            const search = document.getElementById('voucherSearch')?.value || '';
            const status = document.getElementById('voucherStatusFilter')?.value || '';
            const params = new URLSearchParams({ page, limit: 10 });
            if (status) params.append('status', status);

            try {
                const url = `${API_BASE}/vouchers?${params}`;
                const headers = getAuthHeaders();
                
                console.log('üîç Loading vouchers:', url);
                console.log('üîë Headers:', headers);
                
                const response = await fetch(url, { headers });
                const data = await response.json();

                console.log('üì¶ Response status:', response.status);
                console.log('üì¶ Response data:', data);

                if (response.ok) {
                    // Ki·ªÉm tra format response (h·ªó tr·ª£ c·∫£ format c≈© v√† m·ªõi)
                    let vouchers = [];
                    if (data.data && Array.isArray(data.data)) {
                        // Format m·ªõi: { success: true, data: [...] }
                        vouchers = data.data;
                    } else if (data.vouchers && Array.isArray(data.vouchers)) {
                        // Format c≈©: { vouchers: [...] }
                        vouchers = data.vouchers;
                    } else if (Array.isArray(data)) {
                        // Format array tr·ª±c ti·∫øp
                        vouchers = data;
                    }
                    
                    if (vouchers.length > 0) {
                        console.log('‚úÖ Found vouchers:', vouchers.length);
                        renderVouchersTable(vouchers);
                        // Ph√¢n trang (n·∫øu c√≥)
                        if (data.totalPages) {
                            renderPagination('vouchersPagination', data.page || 1, data.totalPages, (p) => {
                                currentPage.vouchers = p;
                                loadVouchers(p);
                            });
                        } else {
                            document.getElementById('vouchersPagination').innerHTML = '';
                        }
                    } else {
                        console.log('‚ö†Ô∏è No vouchers found');
                        document.getElementById('vouchersTable').innerHTML = '<div style="padding: 40px; text-align: center; color: #64748b;">Kh√¥ng c√≥ voucher n√†o! <br><button class="btn btn-primary" onclick="showAddVoucher()" style="margin-top: 10px;">Th√™m voucher ƒë·∫ßu ti√™n</button></div>';
                        document.getElementById('vouchersPagination').innerHTML = '';
                    }
                } else {
                    console.error('‚ùå API Error:', data);
                    document.getElementById('vouchersTable').innerHTML = `<div style="padding: 40px; text-align: center; color: #e74c3c;">L·ªói: ${data.message || 'Kh√¥ng th·ªÉ t·∫£i danh s√°ch voucher'}</div>`;
                }
            } catch (error) {
                console.error('‚ùå Network Error:', error);
                document.getElementById('vouchersTable').innerHTML = '<div style="padding: 40px; text-align: center; color: #e74c3c;">L·ªói k·∫øt n·ªëi server! Vui l√≤ng ki·ªÉm tra console (F12) ƒë·ªÉ xem chi ti·∫øt.</div>';
            }
        }

        function renderVouchersTable(vouchers) {
            const table = `
                <table>
                    <thead>
                        <tr>
                            <th>M√£ voucher</th>
                            <th>T√™n</th>
                            <th>Lo·∫°i</th>
                            <th>Gi√° tr·ªã</th>
                            <th>S·ªë l∆∞·ª£ng</th>
                            <th>ƒê√£ d√πng</th>
                            <th>Ng√†y b·∫Øt ƒë·∫ßu</th>
                            <th>Ng√†y k·∫øt th√∫c</th>
                            <th>Tr·∫°ng th√°i</th>
                            <th>Thao t√°c</th>
                        </tr>
                    </thead>
                    <tbody>
                        ${vouchers.map(voucher => {
                            // H·ªó tr·ª£ c·∫£ format c≈© v√† m·ªõi
                            const code = voucher.code || '';
                            const name = voucher.name || '';
                            const type = voucher.type || voucher.discountType || 'percentage';
                            const value = voucher.value || voucher.discount || 0;
                            const quantity = voucher.quantity || 0;
                            const usedCount = voucher.usedCount || voucher.used || 0;
                            const startDate = voucher.startDate ? new Date(voucher.startDate) : new Date();
                            const endDate = voucher.endDate ? new Date(voucher.endDate) : new Date();
                            const status = voucher.status; // C√≥ th·ªÉ l√† 0/1 ho·∫∑c "active"/"inactive"/"expired"
                            const id = voucher._id || voucher.id || '';
                            
                            // X√°c ƒë·ªãnh tr·∫°ng th√°i hi·ªÉn th·ªã
                            let statusClass = 'status-cancelled';
                            let statusText = 'Kh√¥ng h·ª£p l·ªá';
                            
                            if (typeof status === 'string') {
                                // Format m·ªõi: "active", "inactive", "expired"
                                if (status === 'active') {
                                    statusClass = 'status-completed';
                                    statusText = 'Ho·∫°t ƒë·ªông';
                                } else if (status === 'inactive') {
                                    statusClass = 'status-cancelled';
                                    statusText = 'D·ª´ng ho·∫°t ƒë·ªông';
                                } else if (status === 'expired') {
                                    statusClass = 'status-cancelled';
                                    statusText = 'H·∫øt h·∫°n';
                                }
                            } else {
                                // Format c≈©: 0 ho·∫∑c 1
                                const now = new Date();
                                const isValid = status === 1 && 
                                              quantity > usedCount &&
                                              startDate <= now &&
                                              endDate >= now;
                                statusClass = isValid ? 'status-completed' : 'status-cancelled';
                                statusText = isValid ? 'H·ª£p l·ªá' : 'Kh√¥ng h·ª£p l·ªá';
                            }
                            
                            return `
                            <tr>
                                <td><strong>${code}</strong></td>
                                <td>${name}</td>
                                <td>${type === 'percentage' ? 'Ph·∫ßn trƒÉm' : 'C·ªë ƒë·ªãnh'}</td>
                                <td>${type === 'percentage' ? value + '%' : value.toLocaleString('vi-VN') + ' VNƒê'}</td>
                                <td>${quantity}</td>
                                <td>${usedCount}</td>
                                <td>${startDate.toLocaleDateString('vi-VN')}</td>
                                <td>${endDate.toLocaleDateString('vi-VN')}</td>
                                <td><span class="status-badge ${statusClass}">${statusText}</span></td>
                                <td>
                                    <button class="btn-sm btn-view" onclick="viewVoucher('${id}')">Xem</button>
                                    <button class="btn-sm btn-edit" onclick="editVoucher('${id}')">S·ª≠a</button>
                                    <button class="btn-sm btn-delete" onclick="deleteVoucher('${id}')">X√≥a</button>
                                </td>
                            </tr>
                        `;
                        }).join('')}
                    </tbody>
                </table>
            `;
            document.getElementById('vouchersTable').innerHTML = table;
        }

        function showAddVoucher() {
            document.getElementById('voucherId').value = '';
            document.getElementById('voucherForm').reset();
            document.getElementById('voucherModalTitle').textContent = 'Th√™m voucher';
            document.getElementById('voucherModal').classList.add('active');
            toggleVoucherFields();
        }

        function toggleVoucherFields() {
            const type = document.getElementById('voucherType')?.value;
            const maxDiscountGroup = document.getElementById('maxDiscountGroup');
            if (type === 'percentage' && maxDiscountGroup) {
                maxDiscountGroup.style.display = 'block';
            } else if (maxDiscountGroup) {
                maxDiscountGroup.style.display = 'none';
            }
        }

        async function editVoucher(id) {
            try {
                const response = await fetch(`${API_BASE}/vouchers/${id}`, {
                    headers: getAuthHeaders()
                });
                const result = await response.json();
                
                // H·ªó tr·ª£ c·∫£ format m·ªõi v√† c≈©
                const voucher = result.data || result;

                document.getElementById('voucherId').value = voucher._id || id;
                document.getElementById('voucherCode').value = voucher.code || '';
                document.getElementById('voucherName').value = voucher.name || '';
                document.getElementById('voucherDescription').value = voucher.description || '';
                document.getElementById('voucherType').value = voucher.type || voucher.discountType || 'percentage';
                document.getElementById('voucherValue').value = voucher.value || voucher.discount || '';
                document.getElementById('voucherMaxDiscount').value = voucher.maxDiscount || '';
                document.getElementById('voucherMinOrderValue').value = voucher.minOrderValue || voucher.minOrderAmount || 0;
                document.getElementById('voucherQuantity').value = voucher.quantity || '';
                
                // X·ª≠ l√Ω status (c√≥ th·ªÉ l√† 0/1 ho·∫∑c "active"/"inactive")
                let statusValue = 1;
                if (voucher.status !== undefined) {
                    if (typeof voucher.status === 'string') {
                        statusValue = voucher.status === 'active' ? 1 : 0;
                    } else {
                        statusValue = voucher.status;
                    }
                }
                document.getElementById('voucherStatus').value = statusValue;
                
                const startDate = voucher.startDate ? new Date(voucher.startDate) : new Date();
                const endDate = voucher.endDate ? new Date(voucher.endDate) : new Date();
                document.getElementById('voucherStartDate').value = startDate.toISOString().slice(0, 16);
                document.getElementById('voucherEndDate').value = endDate.toISOString().slice(0, 16);
                
                document.getElementById('voucherProducts').value = voucher.applicableProducts?.map(p => p._id || p).join(', ') || '';
                document.getElementById('voucherCategories').value = voucher.applicableCategories?.map(c => c._id || c).join(', ') || '';
                document.getElementById('voucherUsers').value = voucher.applicableUsers?.map(u => u._id || u).join(', ') || '';

                document.getElementById('voucherModalTitle').textContent = 'S·ª≠a voucher';
                document.getElementById('voucherModal').classList.add('active');
                toggleVoucherFields();
            } catch (error) {
                console.error('Error loading voucher:', error);
                alert('L·ªói t·∫£i d·ªØ li·ªáu voucher!');
            }
        }

        document.getElementById('voucherForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const id = document.getElementById('voucherId').value;
            
            const parseIds = (str) => {
                if (!str || !str.trim()) return [];
                return str.split(',').map(s => s.trim()).filter(s => s);
            };

            const data = {
                code: document.getElementById('voucherCode').value.toUpperCase(),
                name: document.getElementById('voucherName').value,
                description: document.getElementById('voucherDescription').value,
                type: document.getElementById('voucherType').value,
                value: parseFloat(document.getElementById('voucherValue').value),
                minOrderValue: parseFloat(document.getElementById('voucherMinOrderValue').value) || 0,
                quantity: parseInt(document.getElementById('voucherQuantity').value),
                startDate: document.getElementById('voucherStartDate').value,
                endDate: document.getElementById('voucherEndDate').value,
                status: parseInt(document.getElementById('voucherStatus').value),
                applicableProducts: parseIds(document.getElementById('voucherProducts').value),
                applicableCategories: parseIds(document.getElementById('voucherCategories').value),
                applicableUsers: parseIds(document.getElementById('voucherUsers').value)
            };

            if (data.type === 'percentage' && document.getElementById('voucherMaxDiscount').value) {
                data.maxDiscount = parseFloat(document.getElementById('voucherMaxDiscount').value);
            }

            try {
                const url = id ? `${API_BASE}/vouchers/${id}` : `${API_BASE}/vouchers`;
                const method = id ? 'PUT' : 'POST';
                const response = await fetch(url, {
                    method,
                    headers: getAuthHeaders(),
                    body: JSON.stringify(data)
                });

                const result = await response.json();
                if (response.ok) {
                    alert('L∆∞u th√†nh c√¥ng!');
                    closeModal('voucherModal');
                    loadVouchers(currentPage.vouchers);
                } else {
                    document.getElementById('voucherError').textContent = result.message || 'C√≥ l·ªói x·∫£y ra!';
                }
            } catch (error) {
                document.getElementById('voucherError').textContent = 'L·ªói k·∫øt n·ªëi server!';
            }
        });

        async function deleteVoucher(id) {
            if (!confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a voucher n√†y?')) return;

            try {
                const response = await fetch(`${API_BASE}/vouchers/${id}`, {
                    method: 'DELETE',
                    headers: getAuthHeaders()
                });

                if (response.ok) {
                    alert('X√≥a th√†nh c√¥ng!');
                    loadVouchers(currentPage.vouchers);
                } else {
                    const data = await response.json();
                    alert(data.message || 'C√≥ l·ªói x·∫£y ra!');
                }
            } catch (error) {
                alert('L·ªói k·∫øt n·ªëi server!');
            }
        }

        async function viewVoucher(id) {
            try {
                const response = await fetch(`${API_BASE}/vouchers/${id}`, {
                    headers: getAuthHeaders()
                });
                const result = await response.json();
                
                // H·ªó tr·ª£ c·∫£ format m·ªõi v√† c≈©
                const voucher = result.data || result;

                if (response.ok && voucher) {
                    const type = voucher.type || voucher.discountType || 'percentage';
                    const value = voucher.value || voucher.discount || 0;
                    const quantity = voucher.quantity || 0;
                    const usedCount = voucher.usedCount || voucher.used || 0;
                    const minOrderValue = voucher.minOrderValue || voucher.minOrderAmount || 0;
                    const startDate = voucher.startDate ? new Date(voucher.startDate) : new Date();
                    const endDate = voucher.endDate ? new Date(voucher.endDate) : new Date();
                    
                    const now = new Date();
                    let statusText = 'Kh√¥ng h·ª£p l·ªá';
                    if (typeof voucher.status === 'string') {
                        statusText = voucher.status === 'active' ? 'Ho·∫°t ƒë·ªông' : 
                                   voucher.status === 'inactive' ? 'D·ª´ng ho·∫°t ƒë·ªông' : 'H·∫øt h·∫°n';
                    } else {
                        const isValid = voucher.status === 1 && 
                                      quantity > usedCount &&
                                      startDate <= now &&
                                      endDate >= now;
                        statusText = isValid ? 'H·ª£p l·ªá' : 'Kh√¥ng h·ª£p l·ªá';
                    }

                    alert(`Chi ti·∫øt voucher:\n\n` +
                        `M√£: ${voucher.code || 'N/A'}\n` +
                        `T√™n: ${voucher.name || 'N/A'}\n` +
                        `M√¥ t·∫£: ${voucher.description || 'N/A'}\n` +
                        `Lo·∫°i: ${type === 'percentage' ? 'Ph·∫ßn trƒÉm' : 'C·ªë ƒë·ªãnh'}\n` +
                        `Gi√° tr·ªã: ${type === 'percentage' ? value + '%' : value.toLocaleString('vi-VN') + ' VNƒê'}\n` +
                        `Gi·∫£m t·ªëi ƒëa: ${voucher.maxDiscount ? voucher.maxDiscount.toLocaleString('vi-VN') + ' VNƒê' : 'Kh√¥ng gi·ªõi h·∫°n'}\n` +
                        `ƒê∆°n h√†ng t·ªëi thi·ªÉu: ${minOrderValue.toLocaleString('vi-VN')} VNƒê\n` +
                        `S·ªë l∆∞·ª£ng: ${quantity}\n` +
                        `ƒê√£ d√πng: ${usedCount}\n` +
                        `C√≤n l·∫°i: ${quantity - usedCount}\n` +
                        `Ng√†y b·∫Øt ƒë·∫ßu: ${startDate.toLocaleString('vi-VN')}\n` +
                        `Ng√†y k·∫øt th√∫c: ${endDate.toLocaleString('vi-VN')}\n` +
                        `Tr·∫°ng th√°i: ${statusText}\n` +
                        `Hi·ªÉn th·ªã: ${(typeof voucher.status === 'string' ? voucher.status === 'active' : voucher.status === 1) ? 'C√≥' : 'Kh√¥ng'}`);
                } else {
                    alert('Kh√¥ng t√¨m th·∫•y voucher!');
                }
            } catch (error) {
                console.error('Error loading voucher:', error);
                alert('L·ªói t·∫£i d·ªØ li·ªáu voucher!');
            }
        }

        // API Management
        const apiEndpoints = [
            { method: 'POST', path: '/api/auth/login', description: 'ƒêƒÉng nh·∫≠p', auth: false },
            { method: 'POST', path: '/api/auth/logout', description: 'ƒêƒÉng xu·∫•t', auth: true },
            { method: 'PUT', path: '/api/auth/change-password', description: 'ƒê·ªïi m·∫≠t kh·∫©u', auth: true },
            { method: 'GET', path: '/api/auth/me', description: 'L·∫•y th√¥ng tin user hi·ªán t·∫°i', auth: true },
            { method: 'GET', path: '/api/users', description: 'L·∫•y danh s√°ch nh√¢n vi√™n', auth: true, admin: true },
            { method: 'GET', path: '/api/users/:id', description: 'L·∫•y chi ti·∫øt nh√¢n vi√™n', auth: true, admin: true },
            { method: 'POST', path: '/api/users', description: 'Th√™m nh√¢n vi√™n m·ªõi', auth: true, admin: true },
            { method: 'PUT', path: '/api/users/:id', description: 'C·∫≠p nh·∫≠t nh√¢n vi√™n', auth: true, admin: true },
            { method: 'DELETE', path: '/api/users/:id', description: 'X√≥a nh√¢n vi√™n', auth: true, admin: true },
            { method: 'GET', path: '/api/categories', description: 'L·∫•y danh s√°ch lo·∫°i s·∫£n ph·∫©m', auth: false },
            { method: 'GET', path: '/api/categories/all', description: 'L·∫•y t·∫•t c·∫£ lo·∫°i s·∫£n ph·∫©m', auth: false },
            { method: 'GET', path: '/api/categories/:id', description: 'L·∫•y chi ti·∫øt lo·∫°i s·∫£n ph·∫©m', auth: false },
            { method: 'POST', path: '/api/categories', description: 'Th√™m lo·∫°i s·∫£n ph·∫©m', auth: true },
            { method: 'PUT', path: '/api/categories/:id', description: 'C·∫≠p nh·∫≠t lo·∫°i s·∫£n ph·∫©m', auth: true },
            { method: 'DELETE', path: '/api/categories/:id', description: 'X√≥a lo·∫°i s·∫£n ph·∫©m', auth: true },
            { method: 'GET', path: '/api/products', description: 'L·∫•y danh s√°ch s·∫£n ph·∫©m', auth: false },
            { method: 'GET', path: '/api/products/:id', description: 'L·∫•y chi ti·∫øt s·∫£n ph·∫©m', auth: false },
            { method: 'POST', path: '/api/products', description: 'Th√™m s·∫£n ph·∫©m m·ªõi', auth: true },
            { method: 'PUT', path: '/api/products/:id', description: 'C·∫≠p nh·∫≠t s·∫£n ph·∫©m', auth: true },
            { method: 'DELETE', path: '/api/products/:id', description: 'X√≥a/·∫®n s·∫£n ph·∫©m', auth: true },
            { method: 'GET', path: '/api/cart', description: 'L·∫•y gi·ªè h√†ng', auth: true },
            { method: 'POST', path: '/api/cart', description: 'Th√™m v√†o gi·ªè h√†ng', auth: true },
            { method: 'PUT', path: '/api/cart/:id', description: 'C·∫≠p nh·∫≠t gi·ªè h√†ng', auth: true },
            { method: 'DELETE', path: '/api/cart/:id', description: 'X√≥a kh·ªèi gi·ªè h√†ng', auth: true },
            { method: 'GET', path: '/api/orders', description: 'L·∫•y danh s√°ch ƒë∆°n h√†ng', auth: true },
            { method: 'GET', path: '/api/orders/:id', description: 'L·∫•y chi ti·∫øt ƒë∆°n h√†ng', auth: true },
            { method: 'POST', path: '/api/orders', description: 'T·∫°o ƒë∆°n h√†ng m·ªõi', auth: true },
            { method: 'PUT', path: '/api/orders/:id/status', description: 'C·∫≠p nh·∫≠t tr·∫°ng th√°i ƒë∆°n h√†ng', auth: true },
            { method: 'GET', path: '/api/vouchers', description: 'L·∫•y danh s√°ch voucher', auth: false },
            { method: 'GET', path: '/api/vouchers/:id', description: 'L·∫•y chi ti·∫øt voucher', auth: false },
            { method: 'POST', path: '/api/vouchers/check', description: 'Ki·ªÉm tra voucher h·ª£p l·ªá', auth: true },
            { method: 'POST', path: '/api/vouchers', description: 'T·∫°o voucher m·ªõi', auth: true, admin: true },
            { method: 'PUT', path: '/api/vouchers/:id', description: 'C·∫≠p nh·∫≠t voucher', auth: true, admin: true },
            { method: 'DELETE', path: '/api/vouchers/:id', description: 'X√≥a voucher', auth: true, admin: true },
            { method: 'GET', path: '/api/statistics/overview', description: 'T·ªïng h·ª£p th·ªëng k√™', auth: true, admin: true },
            { method: 'GET', path: '/api/statistics/revenue/daily', description: 'Doanh thu theo ng√†y', auth: true, admin: true },
            { method: 'GET', path: '/api/statistics/revenue/monthly', description: 'Doanh thu theo th√°ng', auth: true, admin: true },
            { method: 'GET', path: '/api/dashboard', description: 'Dashboard t·ªïng quan', auth: true, admin: true },
        ];

        function loadAPIs() {
            const apiList = document.getElementById('apiList');
            const grouped = {};
            
            apiEndpoints.forEach(api => {
                const category = api.path.split('/')[2] || 'other';
                if (!grouped[category]) {
                    grouped[category] = [];
                }
                grouped[category].push(api);
            });

            let html = '';
            Object.keys(grouped).sort().forEach(category => {
                html += `<div style="margin-bottom: 30px;">`;
                html += `<h3 style="color: #1e293b; margin-bottom: 15px; padding-bottom: 10px; border-bottom: 2px solid #e2e8f0;">${category.toUpperCase()}</h3>`;
                html += `<div style="display: grid; gap: 12px;">`;
                
                grouped[category].forEach(api => {
                    const methodColor = {
                        'GET': '#10b981',
                        'POST': '#3b82f6',
                        'PUT': '#f59e0b',
                        'DELETE': '#ef4444',
                        'PATCH': '#8b5cf6'
                    }[api.method] || '#64748b';
                    
                    html += `
                        <div style="background: white; padding: 16px; border-radius: 8px; border: 1px solid #e2e8f0; display: flex; align-items: center; gap: 15px;" class="api-item">
                            <span style="background: ${methodColor}; color: white; padding: 4px 12px; border-radius: 4px; font-weight: 600; font-size: 12px; min-width: 60px; text-align: center;">${api.method}</span>
                            <code style="flex: 1; color: #1e293b; font-size: 14px; font-weight: 500;">${api.path}</code>
                            <span style="color: #64748b; font-size: 13px;">${api.description}</span>
                            ${api.auth ? '<span style="background: #fef3c7; color: #92400e; padding: 2px 8px; border-radius: 4px; font-size: 11px;">Auth</span>' : ''}
                            ${api.admin ? '<span style="background: #fee2e2; color: #991b1b; padding: 2px 8px; border-radius: 4px; font-size: 11px;">Admin</span>' : ''}
                        </div>
                    `;
                });
                
                html += `</div></div>`;
            });

            apiList.innerHTML = html;
        }

        function filterAPIs() {
            const search = document.getElementById('apiSearch').value.toLowerCase();
            const items = document.querySelectorAll('.api-item');
            
            items.forEach(item => {
                const text = item.textContent.toLowerCase();
                item.style.display = text.includes(search) ? 'flex' : 'none';
            });
        }

        // Close modals when clicking outside
        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.classList.remove('active');
            }
        }
    </script>
</body>
</html>

